% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fund_imp.R
\name{fund_imp}
\alias{fund_imp}
\title{Import a fund's NAV data and register its benchmark mapping}
\usage{
fund_imp(
  ticker,
  file = NULL,
  data_sheet = 1,
  date_col = "^Date",
  nav_col = "^NAV",
  benchmark = NULL,
  benchmark_col = NULL,
  retrieve_benchmark = FALSE,
  date_order = "dmy",
  default_ext = ".xlsx"
)
}
\arguments{
\item{ticker}{Fund ticker symbol. Used (in lower case) as the storage
key and (in upper case) to derive the default filename.}

\item{file}{Optional filename. If \code{NULL} (the default), it is
constructed as \code{paste0(toupper(ticker), default_ext)}.}

\item{data_sheet}{Sheet index or name containing the NAV data.
Defaults to \code{1}.}

\item{date_col}{Regular expression identifying the date column.
Defaults to \code{"^Date"}.}

\item{nav_col}{Regular expression identifying the fund's NAV column.
Defaults to \code{"^NAV"}.}

\item{benchmark}{Optional benchmark that this fund should
be associated with in the fund index map\verb{. When }retrieve_benchmark = TRUE`, the same value is also used as the name
under which the benchmark series is imported.}

\item{benchmark_col}{Regular expression identifying the benchmark
column in the Excel sheet. Only used when \code{retrieve_benchmark = TRUE}.}

\item{retrieve_benchmark}{Logical; if \code{TRUE}, both \code{benchmark} and
\code{benchmark_col} must be supplied and the benchmark column is imported
alongside the fund.}

\item{date_order}{Date parsing order passed to the importer.
Defaults to \code{"dmy"}.}

\item{default_ext}{Default filename extension used when \code{file} is not
provided. Defaults to \code{".xlsx"}.}
}
\value{
Invisibly returns \code{NULL}. The imported data are stored in
\code{.fundsr_storage} under \code{tolower(ticker)}, and a fund–index mapping
is added to \code{.fundsr$fund_index} if \code{benchmark} is supplied.
}
\description{
Imports a fund's NAV time series from an Excel file and stores it in
the internal storage via \code{setg()}. Optionally, a benchmark column can
also be imported, and a fund–index mapping is recorded in
\code{.fundsr$fund_index}.
}
\details{
The function builds a column-translation mapping from the fund NAV
column and, if requested, a benchmark column. It then calls
\code{import_xl_data()} to read the Excel file and \code{setg()} to cache the
imported object under \code{tolower(ticker)}. When \code{benchmark} is provided,
a corresponding entry is added to \code{.fundsr$fund_index} to link the
fund to its benchmark key.
}
