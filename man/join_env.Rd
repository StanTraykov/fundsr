% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fund_imp.R
\name{join_env}
\alias{join_env}
\title{Join all tibbles in an environment with optional late left-joins}
\usage{
join_env(env, by, late = NULL, coalesce_suffixed = NULL)
}
\arguments{
\item{env}{Environment containing the tibbles to join.}

\item{by}{Character vector of join keys (passed to \code{dplyr::full_join()}).}

\item{late}{Character vector of object names in \code{env} that should be
\emph{excluded} from the initial full join and instead left-joined
afterwards. Defaults to \code{NULL}.}

\item{coalesce_suffixed}{Optional character vector of length 2 giving
join suffixes to coalesce (for example, \code{c(".x", ".y")} or
\code{c(".y", ".x")}). When non-\code{NULL}, any pairs of columns whose names
end in these suffixes (and share the same base name) are replaced by
a single unsuffixed column containing the coalesced values. If
\code{NULL} (the default), no automatic coalescing is performed.}
}
\value{
A tibble: the full join of all non-late objects, followed by
sequential left-joins of the late objects. If \code{coalesce_suffixes}
is supplied, suffixed join columns are coalesced into unsuffixed
base columns as described above.
}
\description{
Performs a \code{dplyr::full_join()} across all objects in an environment,
except those listed in \code{late}. Objects listed in \code{late} are instead
joined afterwards using \code{dplyr::left_join()} in the order given.
Optionally, any columns created with join suffixes (such as \code{.x} /
\code{.y}) can be automatically coalesced into single unsuffixed columns.
}
\details{
This helper is designed for workflows where the majority of tables
should be fully joined, while certain sparse or auxiliary tables
(e.g. calendars, metadata) should only be attached via \code{left_join()}.

When \code{coalesce_suffixed} is provided, the function uses an internal
helper to replace pairs like \code{name.x} / \code{name.y} with a single
\code{name} column whose values are taken from the first suffix in
\code{coalesce_suffixed} and then, where missing, from the second.

If a name in \code{late} does not exist in \code{env}, it is ignored with a
warning.
}
\examples{
\dontrun{
  e <- new.env()
  e$a <- tibble::tibble(date = 1:3, x = 1:3)
  e$b <- tibble::tibble(date = 1:3, x = c(NA, 20, 30))

  # Simple full join of a and b
  join_env(e, by = "date")

  # Full join with automatic coalescing of x.x / x.y into x
  join_env(e, by = "date", coalesce_suffixes = c(".x", ".y"))
}
}
