% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fund_imp.R
\name{join_env}
\alias{join_env}
\title{Join all tibbles in an environment with optional late left-joins}
\usage{
join_env(
  env,
  by = "date",
  late = NULL,
  join_precedence = NULL,
  coalesce_suffixed = NULL,
  late_join = dplyr::left_join
)
}
\arguments{
\item{env}{Environment containing the tibbles to join.}

\item{by}{Character vector of join keys (passed to \code{dplyr::full_join()}).}

\item{late}{Character vector of object names in \code{env} that should be
\emph{excluded} from the initial full join and instead left-joined
afterwards. Defaults to \code{NULL}.}

\item{join_precedence}{Optional character vector of length 2 giving join suffixes to coalesce
(for example, \code{c(".early", ".late")} or \code{c(".late", ".early")}). When non-\code{NULL}, any pairs of
columns whose names end in these suffixes (and share the same base name) are replaced by a
single unsuffixed column containing the coalesced values, preferring the left suffix when both
values are available. If \code{NULL} (the default), no automatic coalescing is performed.}

\item{coalesce_suffixed}{Deprecated; use \code{join_precedence}.}

\item{late_join}{Function to use for joining late objects.}
}
\value{
A tibble: the full join of all non-late objects, followed by sequential left-joins of the
late objects. If \code{join_precedence} is supplied, suffixed join columns are coalesced into
unsuffixed base columns as described above.
}
\description{
Performs a \code{dplyr::full_join()} across all objects in an environment, except those listed in
\code{late}. Objects listed in \code{late} are instead joined afterwards using \code{dplyr::left_join()} (or
another function specified via \code{late_join}) in the order given. Column clashes during the full
join are resolved via join suffixes \code{c(".x", ".y")} while the late joins use
\code{c(".early", ".late")}. Optionally, columns with join suffixes can be automatically coalesced
into single unsuffixed columns via precedence specification (\code{join_precedence}).
}
\examples{
  e <- new.env()
  e$members <- dplyr::band_members
  e$instruments <- dplyr::band_instruments
  e$other_instr <- dplyr::band_instruments |>
      dplyr::mutate(plays = c("banjo", "mellotron", "harpsichord"))

  full <- join_env(e, by = "name")
  late <- join_env(e, by = "name", late = "other_instr")
  late_coalesced <- join_env(e,
                             by = "name",
                             late = "other_instr",
                             join_precedence = c(".late", ".early"))
  print(list(full = full, late = late, late_coalesced = late_coalesced))
}
\seealso{
Other fund/index workflow functions: 
\code{\link{add_data_loader}()},
\code{\link{build_all_series}()},
\code{\link{clear_data_loaders}()},
\code{\link{clear_storage}()},
\code{\link{get_storage}()},
\code{\link{load_fund}()},
\code{\link{run_data_loaders}()},
\code{\link{store_timeseries}()}
}
\concept{fund/index workflow functions}
