% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrappers.R
\name{load_fund}
\alias{load_fund}
\title{Load a fund's NAV data and optionally register its benchmark mapping}
\usage{
load_fund(
  ticker,
  file = NULL,
  sheet = 1,
  date_col = "^Date",
  nav_col = "^NAV",
  benchmark = NULL,
  benchmark_col = NULL,
  retrieve_benchmark = FALSE,
  date_order = "dmy",
  var_name = NULL,
  data_sheet = NULL
)
}
\arguments{
\item{ticker}{Fund ticker symbol. Used (in lower case) as the storage key and
(in upper case) to derive the default filename.}

\item{file}{Optional filename. If \code{NULL} (the default), it is inferred from
\code{ticker} as described above.}

\item{sheet}{Sheet index or name containing the NAV data. Defaults to \code{1}.}

\item{date_col}{Regular expression identifying the date column. Defaults to \code{"^Date"}.}

\item{nav_col}{Regular expression identifying the fund's NAV column. Defaults to \code{"^NAV"}.}

\item{benchmark}{Optional benchmark key that this fund should be associated
with in the fund/index map. When \code{retrieve_benchmark = TRUE}, the same value
is also used as the name under which the benchmark series is imported.}

\item{benchmark_col}{Regular expression identifying the benchmark column in
the Excel sheet. Only used when \code{retrieve_benchmark = TRUE}.}

\item{retrieve_benchmark}{Logical; if \code{TRUE}, both \code{benchmark} and
\code{benchmark_col} must be supplied and the benchmark column is imported
alongside the fund.}

\item{date_order}{Date parsing order passed to the importer. Defaults to \code{"dmy"}.}

\item{var_name}{Specify a custom variable name for the storage environment.}

\item{data_sheet}{Deprecated; use \code{sheet}.}
}
\value{
Invisibly returns \code{NULL}. The imported data are stored in
\code{.fundsr_storage} under \code{tolower(ticker)}. A fund/index mapping is recorded
in \code{.fundsr$fund_index_map} when \code{benchmark} is supplied.
}
\description{
Imports a fund's NAV time series from an Excel file and stores it in the
storage environment via \code{store_timeseries()}. Optionally, a benchmark column
can also be imported, and a fund/index mapping is recorded in
\code{.fundsr$fund_index_map}.
}
\details{
If \code{file} is \code{NULL}, the function searches \code{getOption("fundsr.data_dir")} for
exactly one of \code{paste0(toupper(ticker), ".xlsx")} or
\code{paste0(toupper(ticker), ".xls")}.

The function builds a column-translation mapping from the fund NAV column and,
if requested, a benchmark column. It then calls \code{read_timeseries_excel()} to read the
Excel file and \code{store_timeseries()} to cache the imported object under
\code{tolower(ticker)}. When \code{benchmark} is provided, a corresponding entry is
added to \code{.fundsr$fund_index_map} to link the fund to its benchmark key.
}
\seealso{
Basic functions: \code{\link[=store_timeseries]{store_timeseries()}}, \code{\link[=read_timeseries_excel]{read_timeseries_excel()}}

Vendor-specific wrappers: \code{\link[=amun]{amun()}}, \code{\link[=hsbc]{hsbc()}}, \code{\link[=inve]{inve()}}, \code{\link[=ishs]{ishs()}}, \code{\link[=spdr]{spdr()}}, \code{\link[=ubs]{ubs()}}, \code{\link[=vang]{vang()}}, \code{\link[=xtra]{xtra()}}
}
