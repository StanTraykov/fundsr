% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plots.R
\name{run_plots}
\alias{run_plots}
\title{Generate and export rolling-difference and XLM plots from a specification}
\usage{
run_plots(
  roll_diffs,
  n_days,
  plot_spec,
  xlm_data = NULL,
  add_gg_params = ggplot2::geom_blank(),
  bmark_type = c("net", "gross"),
  suffix = "",
  ...
)
}
\arguments{
\item{roll_diffs}{A list of length 2 containing data frames, named \code{cagr}
and \code{log} (CAGR differences and log-return differences).}

\item{n_days}{Rolling-window length in days (passed to \code{\link[=plot_roll_diffs]{plot_roll_diffs()}}
for labelling).}

\item{plot_spec}{A data frame or a list of data frames describing plot
parameters. Expected columns include: \code{plot_id}, \code{title}, \code{data_filter},
\code{gg_params}, \code{width}, \code{height}, \code{funds}.}

\item{xlm_data}{Optional data frame used to produce XLM plots, including
\code{date}, \code{xlm}, \code{ticker}, and \code{name} columns. Defaults to \code{NULL}.}

\item{add_gg_params}{Optional ggplot component (or list of components)
appended to each generated plot in addition to the per-plot \code{gg_params}
defined in \code{plot_spec}. Defaults to \code{\link[ggplot2:geom_blank]{ggplot2::geom_blank()}}.}

\item{bmark_type}{Benchmark type used in plot titles: \code{"net"} or \code{"gross"}.}

\item{suffix}{Character string appended to each \code{plot_id} when constructing
filenames and names in the returned environment. Defaults to \code{""}.}

\item{...}{Additional arguments passed to \code{\link[=plot_roll_diffs]{plot_roll_diffs()}}.}
}
\value{
An environment containing ggplot objects. Objects are stored under names
corresponding to the base filenames used in \code{\link[=save_plot]{save_plot()}}:
\itemize{
\item \verb{plot_id\{suffix\}} for the CAGR variant,
\item \verb{plot_id\{suffix\}_L} for the log-return variant,
\item and (when generated) \verb{xlm_plot_id\{suffix\}} for XLM plots.
}
}
\description{
Iterates over plot specifications and produces rolling-difference plots for
both CAGR and log-return variants. Each plot is saved via \code{\link[=save_plot]{save_plot()}}, and
optional XLM plots may also be generated. All generated plot objects are
stored in an environment and returned.
}
\details{
For each row in \code{plot_spec}, the function constructs both a CAGR-based and a
log-return-based variant using \code{\link[=plot_roll_diffs]{plot_roll_diffs()}} and writes the resulting
plots via \code{\link[=save_plot]{save_plot()}}, using a filename suffix (\verb{_L}) to distinguish the
log-return variant. The optional \code{suffix} is appended to \code{plot_id} before
filenames (and environment keys) are formed. Additional arguments in \code{...}
are forwarded to \code{\link[=plot_roll_diffs]{plot_roll_diffs()}}.

If \code{plot_spec} is provided as a list of data frames, the function binds them
into a single specification. The \code{title} column may be provided as a list
column (e.g. to keep a multilingual named vector as a single per-row value).

If \code{xlm_data} is supplied, an XLM plot is generated once per unique set of
Xetra tickers using \code{\link[=plot_xlms]{plot_xlms()}}. Fund tickers are mapped to Xetra tickers
via the \code{fundsr.xetra_map} option (tickers not present in the map are used
as-is). The first plot specification encountered for a given ticker set
determines the base filename \verb{xlm_<plot_id\{suffix\}>} used for saving and
storing the resulting XLM plot.
}
\examples{
\dontrun{
plots <- run_plots(roll_diffs, n_days, plot_spec, xlm_data = xlm_data)
plots[["global"]]
plots[["global_L"]]
plots[["xlm_global"]]
}
}
\seealso{
Other plot export utilities: 
\code{\link{clear_inkscape_queue}()},
\code{\link{export_pngs}()},
\code{\link{save_plot}()}
}
\concept{plot export utilities}
