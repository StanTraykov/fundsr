# roll_diffs works for 2 indices + 4 funds

    Code
      snap
    Output
      $log_na
               date f1 f2 g1 g2
      1  2024-01-01 NA NA NA NA
      2  2024-01-02 NA NA NA NA
      3  2024-01-03 NA NA NA NA
      4  2024-01-04 NA NA NA NA
      5  2024-01-05 NA NA NA NA
      6  2024-01-06 NA NA NA NA
      7  2024-01-07 NA NA NA NA
      8  2024-01-08 NA NA NA NA
      9  2024-01-09 NA NA NA NA
      10 2024-01-10 NA NA NA NA
      
      $cagr_na
               date f1 f2 g1 g2
      1  2024-01-01 NA NA NA NA
      2  2024-01-02 NA NA NA NA
      3  2024-01-03 NA NA NA NA
      4  2024-01-04 NA NA NA NA
      5  2024-01-05 NA NA NA NA
      6  2024-01-06 NA NA NA NA
      7  2024-01-07 NA NA NA NA
      8  2024-01-08 NA NA NA NA
      9  2024-01-09 NA NA NA NA
      10 2024-01-10 NA NA NA NA
      
      $log_tail
                date            f1           f2           g1            g2
      631 2025-09-22 -0.0028884432  0.042260043 -0.012642317  0.0137341067
      632 2025-09-23 -0.0103692277  0.039662274 -0.014793344  0.0082646566
      633 2025-09-24 -0.0029294499  0.037472513 -0.028700475 -0.0149960130
      634 2025-09-25 -0.0136025530  0.036992541 -0.014626345 -0.0125174920
      635 2025-09-26  0.0055459275  0.036587874 -0.021160362 -0.0186571796
      636 2025-09-27 -0.0206026037  0.046853444 -0.005901003  0.0122645876
      637 2025-09-28 -0.0172343637  0.035243267 -0.016047668 -0.0050678058
      638 2025-09-29 -0.0143212369  0.034095252 -0.021281755  0.0083546226
      639 2025-09-30 -0.0139158486  0.030571480 -0.010888194 -0.0029805999
      640 2025-10-01 -0.0335274539  0.031584903 -0.015023639 -0.0011808641
      641 2025-10-02 -0.0174018543  0.048021640 -0.012833069  0.0069415789
      642 2025-10-03 -0.0078462441  0.020822604 -0.009872330  0.0061828448
      643 2025-10-04 -0.0160444663  0.047134531  0.006395653 -0.0045646027
      644 2025-10-05 -0.0108848303  0.023939373 -0.012655674  0.0171496874
      645 2025-10-06 -0.0078723841  0.025905555 -0.006551244  0.0080078461
      646 2025-10-07 -0.0166524571  0.030233156 -0.015036924  0.0008446601
      647 2025-10-08 -0.0158347638  0.039639748  0.005981547 -0.0101468611
      648 2025-10-09 -0.0221659220  0.045479897 -0.009412943 -0.0098289746
      649 2025-10-10 -0.0370753545  0.023106440 -0.017222674  0.0007950034
      650 2025-10-11 -0.0245870106  0.040678941 -0.008028409  0.0150336065
      651 2025-10-12 -0.0316187516  0.028091018 -0.014571560  0.0016130702
      652 2025-10-13 -0.0296121264  0.031324379 -0.013996838  0.0143135412
      653 2025-10-14 -0.0131959220  0.013775884 -0.015472096  0.0216512990
      654 2025-10-15 -0.0234516402  0.033564264 -0.018658867 -0.0090325721
      655 2025-10-16 -0.0156213515  0.024592840 -0.021021896 -0.0026463576
      656 2025-10-17 -0.0283803669  0.018958667 -0.018261004 -0.0086567346
      657 2025-10-18 -0.0161931202  0.032244959 -0.019909227 -0.0190428811
      658 2025-10-19 -0.0243159017  0.019294101 -0.008453462 -0.0084626682
      659 2025-10-20 -0.0268988286  0.010001440 -0.009357986 -0.0064768000
      660 2025-10-21 -0.0209030008  0.013831389 -0.024744686 -0.0061395640
      661 2025-10-22 -0.0276138649  0.039107307 -0.027202451 -0.0170767957
      662 2025-10-23 -0.0222517848  0.037243184 -0.024577074 -0.0111914860
      663 2025-10-24 -0.0156921229  0.022397154 -0.024490193  0.0031986776
      664 2025-10-25 -0.0003559787  0.037851747 -0.022442056 -0.0118137425
      665 2025-10-26 -0.0182578562  0.028906047 -0.033932994  0.0148789920
      666 2025-10-27 -0.0222006338  0.013375139 -0.026118593 -0.0076958838
      667 2025-10-28 -0.0264533349  0.027954878 -0.016464949 -0.0152703412
      668 2025-10-29 -0.0169184220  0.027867195 -0.047547090 -0.0086814143
      669 2025-10-30 -0.0201550976  0.032675875 -0.033288984  0.0001490733
      670 2025-10-31 -0.0238758043  0.020140681 -0.023022374 -0.0101520020
      671 2025-11-01 -0.0169072397  0.033297634 -0.028642255 -0.0179839382
      672 2025-11-02 -0.0123496553  0.029644858 -0.018720645  0.0093683779
      673 2025-11-03 -0.0139214793  0.022086814 -0.030834504 -0.0132387428
      674 2025-11-04 -0.0057918842  0.029552138 -0.021621003 -0.0156258640
      675 2025-11-05 -0.0078558578  0.011406279 -0.046263487  0.0000267442
      676 2025-11-06 -0.0069795837  0.025944902 -0.033643436 -0.0018436176
      677 2025-11-07 -0.0128571723  0.034228120 -0.032756273 -0.0070305526
      678 2025-11-08 -0.0161546027  0.019202272 -0.041651943 -0.0093888825
      679 2025-11-09 -0.0334168913  0.022685549 -0.040304761  0.0121627730
      680 2025-11-10 -0.0087795955  0.022110181 -0.034070411 -0.0080182380
      681 2025-11-11 -0.0213783577  0.016978512 -0.045017640 -0.0167772319
      682 2025-11-12 -0.0112793065  0.030333329 -0.058107625  0.0082104974
      683 2025-11-13 -0.0195061489  0.012145532 -0.052693901 -0.0074316504
      684 2025-11-14 -0.0116368823  0.025351135 -0.048303533 -0.0132976398
      685 2025-11-15 -0.0090526939  0.032454072 -0.043895064  0.0063368074
      686 2025-11-16 -0.0244542821  0.031280151 -0.041063604 -0.0083471630
      687 2025-11-17 -0.0164979427  0.036609086 -0.054632410 -0.0188841301
      688 2025-11-18 -0.0095327031  0.028214097 -0.042274927 -0.0157375706
      689 2025-11-19 -0.0136304568  0.026484621 -0.044068406 -0.0046032593
      690 2025-11-20 -0.0226197097  0.034848193 -0.033537311  0.0007344949
      691 2025-11-21 -0.0099315873  0.033757258 -0.028146524  0.0037509357
      692 2025-11-22  0.0048855040  0.020256232 -0.037893943 -0.0018246564
      693 2025-11-23 -0.0116548198  0.016744921 -0.046076429  0.0004911326
      694 2025-11-24 -0.0107997411  0.025474774 -0.043114567 -0.0104801232
      695 2025-11-25 -0.0159765770  0.038236767 -0.049082609  0.0063638968
      696 2025-11-26 -0.0173383423  0.013458505 -0.038875382 -0.0048510805
      697 2025-11-27 -0.0090964040  0.035576002 -0.038620045  0.0042633393
      698 2025-11-28 -0.0131080321  0.014548534 -0.027528678 -0.0156916174
      699 2025-11-29 -0.0070131245  0.012313084 -0.043759885 -0.0020599145
      700 2025-11-30 -0.0184785326  0.025405457 -0.030501949  0.0076591003
      701 2025-12-01 -0.0107604954  0.029210059 -0.051013754  0.0099050825
      702 2025-12-02 -0.0033227254  0.018154884 -0.039779744  0.0059165430
      703 2025-12-03 -0.0173366087  0.011918180 -0.025531532 -0.0246746755
      704 2025-12-04 -0.0026184183  0.024446738 -0.022944385 -0.0177490536
      705 2025-12-05 -0.0107719379  0.016962636 -0.031738867 -0.0304338594
      706 2025-12-06 -0.0126569040  0.011935457 -0.032766756 -0.0158194712
      707 2025-12-07 -0.0071575362  0.015136044 -0.030864648 -0.0204212088
      708 2025-12-08 -0.0218482183  0.016407460 -0.027088575 -0.0030429777
      709 2025-12-09 -0.0131362484  0.005270199 -0.042676704 -0.0113643998
      710 2025-12-10 -0.0151930175  0.009272910 -0.025657580  0.0016075172
      711 2025-12-11 -0.0070984935  0.003396107 -0.007326620 -0.0118222894
      712 2025-12-12 -0.0071312891  0.008201460 -0.027204698 -0.0104884859
      713 2025-12-13 -0.0060652807  0.003625307 -0.030080381 -0.0041336406
      714 2025-12-14 -0.0051076252  0.010798478 -0.032394615 -0.0225214012
      715 2025-12-15 -0.0120950629  0.024086671 -0.034730764 -0.0332003889
      716 2025-12-16 -0.0226325943  0.010098986 -0.052877398 -0.0240281508
      717 2025-12-17 -0.0171390435  0.007084815 -0.035730293 -0.0109397632
      718 2025-12-18 -0.0070495432  0.010165229 -0.045048334 -0.0328081259
      719 2025-12-19 -0.0075834951  0.020974004 -0.030274791 -0.0126722433
      720 2025-12-20 -0.0099412723  0.018247896 -0.029407733 -0.0201576428
      721 2025-12-21 -0.0029803123 -0.001420752 -0.026882488 -0.0402946784
      722 2025-12-22 -0.0230476352  0.024600257 -0.041906216 -0.0021249823
      723 2025-12-23 -0.0136547702 -0.001855553 -0.032506801 -0.0298021906
      724 2025-12-24 -0.0127464246  0.002896361 -0.029180546 -0.0246192301
      725 2025-12-25 -0.0007345026  0.009042702 -0.039089066 -0.0387326737
      726 2025-12-26 -0.0205517761  0.023660456 -0.037623046 -0.0226280681
      727 2025-12-27 -0.0219788274  0.024876829 -0.047173741 -0.0228531057
      728 2025-12-28 -0.0170333152  0.018541833 -0.032606530 -0.0356554483
      729 2025-12-29 -0.0220640831  0.019128519 -0.031500497 -0.0378618927
      730 2025-12-30 -0.0109826239  0.020620973 -0.026032591 -0.0239118446
      
      $cagr_tail
                date            f1           f2           g1            g2
      631 2025-09-22 -0.0028783873  0.043077587 -0.012223731  0.0134556787
      632 2025-09-23 -0.0102918798  0.040366084 -0.014267288  0.0080631392
      633 2025-09-24 -0.0029223310  0.038146490 -0.027396566 -0.0144127846
      634 2025-09-25 -0.0135112893  0.037687604 -0.014086612 -0.0120682689
      635 2025-09-26  0.0055513043  0.037198237 -0.020472512 -0.0180732312
      636 2025-09-27 -0.0203282893  0.047818966 -0.005719736  0.0119963686
      637 2025-09-28 -0.0170497136  0.035794019 -0.015365316 -0.0048789863
      638 2025-09-29 -0.0142436207  0.034742783 -0.020285901  0.0080824351
      639 2025-09-30 -0.0136963383  0.030766986 -0.010420448 -0.0028638439
      640 2025-10-01 -0.0327169283  0.031841108 -0.014326762 -0.0011338998
      641 2025-10-02 -0.0169390706  0.048302968 -0.012326549  0.0067338148
      642 2025-10-03 -0.0077178867  0.020777999 -0.009463295  0.0059744281
      643 2025-10-04 -0.0157166889  0.047657325  0.006236482 -0.0044266722
      644 2025-10-05 -0.0107103589  0.023969851 -0.012302002  0.0169208160
      645 2025-10-06 -0.0077360704  0.025891239 -0.006389270  0.0078669252
      646 2025-10-07 -0.0161964007  0.030103451 -0.014640249  0.0008289265
      647 2025-10-08 -0.0154649178  0.039804938  0.005910841 -0.0099464108
      648 2025-10-09 -0.0213777965  0.045374751 -0.009276473 -0.0096844618
      649 2025-10-10 -0.0355312671  0.022819783 -0.017038458  0.0007936076
      650 2025-10-11 -0.0237320726  0.040568683 -0.007965867  0.0150895930
      651 2025-10-12 -0.0305079101  0.027925259 -0.014387064  0.0016055729
      652 2025-10-13 -0.0285858103  0.031174354 -0.013795001  0.0143082526
      653 2025-10-14 -0.0128780339  0.013626567 -0.015268633  0.0217670890
      654 2025-10-15 -0.0226436030  0.033345767 -0.018405035 -0.0089525822
      655 2025-10-16 -0.0151090405  0.024269783 -0.020613161 -0.0026188075
      656 2025-10-17 -0.0270656673  0.018513136 -0.017946623 -0.0085485619
      657 2025-10-18 -0.0155200089  0.031663252 -0.019460749 -0.0186219572
      658 2025-10-19 -0.0232302547  0.018838832 -0.008264682 -0.0082736446
      659 2025-10-20 -0.0256878111  0.009728766 -0.009167891 -0.0063543678
      660 2025-10-21 -0.0199601293  0.013438739 -0.024015121 -0.0060140913
      661 2025-10-22 -0.0262963370  0.038505978 -0.026366547 -0.0166357449
      662 2025-10-23 -0.0212619674  0.036662385 -0.023897438 -0.0109548620
      663 2025-10-24 -0.0149632191  0.021767662 -0.023763174  0.0031469121
      664 2025-10-25 -0.0003410982  0.036971237 -0.021951479 -0.0116168921
      665 2025-10-26 -0.0172611159  0.027980688 -0.032936011  0.0147980635
      666 2025-10-27 -0.0208725282  0.012800517 -0.025503682 -0.0075840427
      667 2025-10-28 -0.0247921104  0.026921964 -0.016120387 -0.0149596882
      668 2025-10-29 -0.0158739497  0.026739442 -0.046077748 -0.0085774425
      669 2025-10-30 -0.0189054466  0.031471202 -0.032524747  0.0001480997
      670 2025-10-31 -0.0223963694  0.019312960 -0.022599051 -0.0100294898
      671 2025-11-01 -0.0157898644  0.031888626 -0.028138107 -0.0177614290
      672 2025-11-02 -0.0115986375  0.028433718 -0.018507111  0.0093924075
      673 2025-11-03 -0.0130224669  0.021036107 -0.030185648 -0.0130742602
      674 2025-11-04 -0.0054317261  0.028209601 -0.021096048 -0.0152920994
      675 2025-11-05 -0.0073658171  0.010798297 -0.044507031  0.0000263289
      676 2025-11-06 -0.0064989330  0.024559829 -0.032422115 -0.0018050809
      677 2025-11-07 -0.0118946936  0.032421529 -0.031591218 -0.0068679813
      678 2025-11-08 -0.0149064622  0.018034767 -0.039925977 -0.0091455583
      679 2025-11-09 -0.0306486392  0.021397648 -0.038552729  0.0119425711
      680 2025-11-10 -0.0081274998  0.020786905 -0.032415371 -0.0077284052
      681 2025-11-11 -0.0196716121  0.015925434 -0.042631394 -0.0161126831
      682 2025-11-12 -0.0104071243  0.028577145 -0.054563453  0.0079685466
      683 2025-11-13 -0.0179423613  0.011349937 -0.049507736 -0.0071413006
      684 2025-11-14 -0.0107908801  0.023947416 -0.045512209 -0.0127492899
      685 2025-11-15 -0.0083658227  0.030621797 -0.041380452  0.0061252472
      686 2025-11-16 -0.0223122247  0.029347173 -0.038745596 -0.0080053294
      687 2025-11-17 -0.0150174273  0.034222049 -0.051178457 -0.0180073122
      688 2025-11-18 -0.0087131675  0.026280615 -0.040120052 -0.0151339037
      689 2025-11-19 -0.0125599995  0.024899647 -0.041642564 -0.0044361942
      690 2025-11-20 -0.0206549872  0.032749892 -0.031910710  0.0007109167
      691 2025-11-21 -0.0091408671  0.031757159 -0.026961324  0.0036506351
      692 2025-11-22  0.0045334770  0.018941981 -0.036022653 -0.0017660111
      693 2025-11-23 -0.0106556900  0.015528470 -0.043979550  0.0004797824
      694 2025-11-24 -0.0098793186  0.023730699 -0.041262607 -0.0101942166
      695 2025-11-25 -0.0145698494  0.035829983 -0.047095335  0.0062772666
      696 2025-11-26 -0.0158228944  0.012472700 -0.037741696 -0.0047901222
      697 2025-11-27 -0.0083095840  0.033234456 -0.037211020  0.0041965659
      698 2025-11-28 -0.0119846259  0.013486911 -0.026592034 -0.0152473736
      699 2025-11-29 -0.0064195878  0.011380489 -0.041958920 -0.0020165908
      700 2025-11-30 -0.0168183027  0.023636136 -0.029598542  0.0075751507
      701 2025-12-01 -0.0097891982  0.027110663 -0.049201484  0.0098476376
      702 2025-12-02 -0.0030445156  0.016814610 -0.038729566  0.0058930956
      703 2025-12-03 -0.0157696875  0.011000656 -0.025360463 -0.0245198069
      704 2025-12-04 -0.0024016327  0.022728789 -0.022950896 -0.0178001127
      705 2025-12-05 -0.0098204268  0.015680339 -0.031667424 -0.0303850708
      706 2025-12-06 -0.0114554442  0.010936122 -0.032590036 -0.0158675002
      707 2025-12-07 -0.0064845890  0.013866776 -0.031022980 -0.0206329678
      708 2025-12-08 -0.0196096148  0.015010589 -0.027282768 -0.0031017684
      709 2025-12-09 -0.0119022851  0.004819259 -0.042801545 -0.0115766749
      710 2025-12-10 -0.0139177303  0.008599050 -0.025936169  0.0016472307
      711 2025-12-11 -0.0065877023  0.003168308 -0.007501046 -0.0120766109
      712 2025-12-12 -0.0066271292  0.007680303 -0.027438146 -0.0106669960
      713 2025-12-13 -0.0056384523  0.003386551 -0.030445521 -0.0042382931
      714 2025-12-14 -0.0047214965  0.010061873 -0.032738313 -0.0228724667
      715 2025-12-15 -0.0110701962  0.022448565 -0.034920483 -0.0334071563
      716 2025-12-16 -0.0203655637  0.009237193 -0.052341565 -0.0241280020
      717 2025-12-17 -0.0154195444  0.006451626 -0.035790141 -0.0110942260
      718 2025-12-18 -0.0064005834  0.009309253 -0.044458683 -0.0325761659
      719 2025-12-19 -0.0068901401  0.019330723 -0.030099344 -0.0127097803
      720 2025-12-20 -0.0090121005  0.016777309 -0.029222424 -0.0201230946
      721 2025-12-21 -0.0027107105 -0.001293237 -0.026744067 -0.0398207625
      722 2025-12-22 -0.0207726582  0.022706662 -0.041219716 -0.0021320066
      723 2025-12-23 -0.0124373149 -0.001700100 -0.032171828 -0.0295347937
      724 2025-12-24 -0.0116760283  0.002673951 -0.028888296 -0.0244280624
      725 2025-12-25 -0.0006752016  0.008353392 -0.038502302 -0.0381580149
      726 2025-12-26 -0.0188502746  0.022186791 -0.036809636 -0.0223046195
      727 2025-12-27 -0.0199742848  0.023144018 -0.045869002 -0.0224912993
      728 2025-12-28 -0.0155882611  0.017273373 -0.032112308 -0.0350618270
      729 2025-12-29 -0.0201980644  0.017875076 -0.031107384 -0.0372713421
      730 2025-12-30 -0.0101032746  0.019272291 -0.025911573 -0.0238258312
      

